<?phpnamespace App\Http\Controllers\Poker;use App\Http\Controllers\Controller;use App\Models\Poker\Audit;use App\Models\Poker\Club;use App\Models\Poker\ClubUser;use App\Models\Poker\License;use App\Models\Poker\ClubIndicado;use Illuminate\Http\Request;use Illuminate\Support\Facades\DB;use Illuminate\Support\Facades\Session;use Illuminate\Support\Facades\View;class AuditController extends Controller{    /**     * Display a listing of the resource.     *     * @param  \Illuminate\Http\Request  $request     * @return \Illuminate\Http\Response     */    public function index(Request $request)    {        $countreg = 100;        if (!empty($request['count'])) {            //if (is_numeric($request['count'])) {                $countreg = intval($request['count']);            //}        }        $lista = Audit::            select('*')            ->orderby('id','desc')            ->limit($countreg)            ->get();        $lista_oount = count($lista);        for ( $iw = 0; $iw < $lista_oount; $iw++  ) {            $adm = DB::table('users')->where('id', '=', $lista[$iw]['user_id'])->first();            $lista[$iw]['adm'] = $adm->name;            if ($lista[$iw]['model'] === 'CLUB') {                $club = Club::where('id', '=', $lista[$iw]['reg_id'])->first();                $lista[$iw]['club'] = $club['name'];            } elseif ($lista[$iw]['model'] === 'CLUB_USER') {                $clubuser = ClubUser::where('id', '=', $lista[$iw]['reg_id'])->first();                $club = Club::where('id', '=', $clubuser['club_id'])->first();                $lista[$iw]['club'] = $club['name'] . ' / Usr: ' . $clubuser['id'];            } elseif ($lista[$iw]['model'] === 'LICENSE') {                $clublisc = License::where('id', '=', $lista[$iw]['reg_id'])->first();                $club = Club::where('id', '=', $clublisc['club_id'])->first();                $lista[$iw]['club'] = $club['name'] . ' / Usr: ' . $clublisc['id'];            } elseif ($lista[$iw]['model'] === 'CLUB_INDICADO') {                $club = ClubIndicado::where('id', '=', $lista[$iw]['reg_id'])->first();                $lista[$iw]['club'] = $club['name'];            } else {                $lista[$iw]['club'] = '-';            }        }        return view('poker.audit.list',compact('lista'));    }}